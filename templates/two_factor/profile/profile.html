{% extends 'accounts/base.html' %}
{% load i18n two_factor %}

{% block title %}Account security | {{ block.super }}{% endblock %}
{% block page_title %}Account security{% endblock %}

{% block content %}

  {% if default_device %}

    <h3>
      {% trans 'Two-factor authentication is enabled' %}
    </h3>

    {% if default_device_type == 'PhoneDevice' %}
      <p>
        {% blocktrans with action=default_device|device_action trimmed %}
          Primary method: {{ action }}
        {% endblocktrans %}
      </p>
    {% else %}
      <p>{% trans 'Tokens will be generated by your token generator.' %}</p>
    {% endif %}

    <h4>{% trans 'Backup Phone Numbers' %}</h4>
    <p>
      {% blocktrans %}
        If your primary method is not available, we are able to
        send backup tokens to the phone numbers listed below.
      {% endblocktrans %}
    </p>
    <ul>
      {% for phone in backup_phones %}
      <li>
        {{ phone|device_action }}
        <form method="post" action="{% url 'two_factor:phone_delete' phone.id %}"
              onsubmit="return confirm('{% trans 'Are you sure?' %}')">
          {% csrf_token %}
          <button class="button tiny alert" type="submit">{% trans 'Delete' %}</button>
        </form>
      </li>
      {% empty %}
      <li>
        {% trans 'You have no backup phone number defined.' %}
      </li>
      {% endfor %}
    </ul>
    <p>
      <a href="{% url 'two_factor:phone_create' %}" class="button small">
        {% trans 'Add Phone Number' %}
      </a>
    </p>

    <h4>Backup Tokens</h4>
    <p>
      {% trans "If you don't have any device with you, you can access your account using backup tokens." %}
      {% blocktrans count tokens=backup_tokens %}
        You have only one backup token remaining.
      {% plural %}
        You have {{ tokens }} backup tokens remaining.
      {% endblocktrans %}
    </p>
    <p>
      <a href="{% url 'two_factor:backup_tokens' %}" class="button small">
        {% trans 'Manage backup codes' %}
      </a>
    </p>

    <p>
      <a href="{% url 'two_factor:disable' %}" class="button small secondary">
        {% trans 'Disable two-factor authentication' %}
      </a>
    </p>
  {% else %}
    <p>
      {% blocktrans %}
        Two-factor authentication is not enabled for your account. Enable two-
        factor authentication for enhanced account security.
      {% endblocktrans %}
    </p>
    <p>
      <a href="{% url 'two_factor:setup' %}" class="button small">
        {% trans 'Enable two-factor authentication' %}
      </a>
    </p>
  {% endif %}

{% endblock %}
