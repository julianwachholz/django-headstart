{% extends 'accounts/base.html' %}
{% load i18n sniplates %}

{% block title %}Enable Two-Factor Authentication | {{ block.super }}{% endblock %}
{% block page_title %}Enable Two-Factor Authentication{% endblock %}

{% block content %}

  <form method="post">
    {% load_widgets form='widgets/foundation.html' %}
    {% csrf_token %}

    {{ wizard.management_form }}

    {% if wizard.steps.current == 'welcome' %}
      <p>
        {% blocktrans %}
          You are about to take your account security to the next level. Follow the
          steps in this wizard to enable two-factor authentication.
        {% endblocktrans %}
      </p>
    {% elif wizard.steps.current == 'method' %}
      <p>
        {% trans 'Please select which authentication method you would like to use.' %}
      </p>

      {% form_field form.method %}

    {% elif wizard.steps.current == 'generator' %}
      <p>
        {% blocktrans %}
          To start using a token generator, please use your smartphone to scan the
          QR code below. For example, use Google Authenticator. Then, enter the
          token generated by the app.
        {% endblocktrans %}
      </p>
      <p class="text-center"><img src="{{ QR_URL }}" alt="QR Code"></p>

      {% form_field form.token %}

    {% elif wizard.steps.current == 'sms' %}
      <p>
        {% blocktrans %}
          Please enter the phone number you wish to receive the text messages on.
          This number will be validated in the next step.
        {% endblocktrans %}
      </p>

      {% form_field form.number %}

    {% elif wizard.steps.current == 'validation' %}
      <p>
        {% trans 'We sent you a text message, please enter the token we sent.' %}
      </p>

      {% form_field form.token %}

    {% endif %}

    <input type="submit" class="hide">

    {% if wizard.steps.prev %}
      <button type="submit" class="button small secondary" formnovalidate
              name="wizard_goto_step" value="{{ wizard.steps.prev }}">
        {% trans 'Back' %}
      </button>
    {% endif %}
    <button type="submit" class="button small">{% trans 'Next' %}</button>

  </form>

{% endblock %}
